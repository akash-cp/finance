<h1>Incomes</h1>
<hr class="hr">

<%= form_tag incomes_path, method: 'get', remote: true do %>
    <b>Start Date: </b><input type="text" name="start_date" class="date-input" value="<%=params[:start_date]%>"/>&nbsp;

   <b>End Date: </b><input type="text" name="end_date" class="date-input" value="<%=params[:end_date]%>"/>&nbsp;

    <%= label_tag :user, 'User: ' %>
    <%= collection_select('', :user_id, @users , :id, :name, {selected: params[:user_id], include_blank: 'All'},{ class: 'btn btn-sm btn-default '})%>&nbsp;

    <%= label_tag :category, 'Category: ' %>
    <%= collection_select('', :category_id, @income_categories, :id, :name, {selected: params[:category_id], include_blank: 'All'},{ class: 'btn btn-sm btn-default '})%>&nbsp;

    <%= submit_tag('Go', class: 'btn btn-sm btn-primary') %>


    <div class="dropdown">
      <button class="dropbtn">Dropdown</button>
      <div class="dropdown-content">
        <a href="<%=incomes_path(start_date: params[:start_date],end_date: params[:end_date], user_id: params[:user_id], category_id: params[:category_id], format: :pdf)%>">Pdf</a>
        <a href="<%=incomes_path(start_date: params[:start_date],end_date: params[:end_date], user_id: params[:user_id], category_id: params[:category_id],format: :xls)%>">Xls</a>
      </div>
    </div>

    <span class="dropdown"><button href="#" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown">Export&nbsp;<span class="caret"></span></button>
      <ul class="dropdown-menu">
        <li><a href="<%=incomes_path(start_date: params[:start_date],end_date: params[:end_date], user_id: params[:user_id], category_id: params[:category_id], format: :pdf)%>">Pdf</a></li>
        <li><a href="<%=incomes_path(start_date: params[:start_date],end_date: params[:end_date], user_id: params[:user_id], category_id: params[:category_id],format: :xls)%>">Xls</a></li>
      </ul>
    </span>


<% end %>

<hr class="hr">

<%= link_to 'New Income', new_income_path , class: 'btn btn-sm btn-success', remote: true  %>

<br><br>

<table id="incomes"  class="table">
  <thead>
  <tr>
    <th class="col-xs-1">Amount</th>
    <th class="col-xs-1">Date</th>
    <th class="col-xs-2">Category</th>
    <th class="col-xs-1">Created By</th>
    <th class="col-xs-1">Updated By</th>
    <th class="col-xs-1">Attachment</th>
    <th class="col-xs-1"></th>
  </tr>
  </thead>
  <tbody>
    <%= render partial: 'income', collection: @incomes %>
  </tbody>
</table>


<legend><h2>Analytics</h2></legend>
<div id="chart">
<%= pie_chart @income_category_count %>
</div>